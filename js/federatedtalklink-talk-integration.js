/*! For license information please see federatedtalklink-talk-integration.js.LICENSE.txt */
(()=>{"use strict";var e,t,n,r={244(e,t,n){var r=n(3814),o=n(5289),a=n(6802);function i(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var i=r&&r.prototype instanceof u?r:u,d=Object.create(i.prototype);return c(d,"_invoke",function(n,r,o){var a,i,c,u=0,d=o||[],s=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return a=t,i=0,c=e,f.n=n,l}};function p(n,r){for(i=n,c=r,t=0;!s&&u&&!o&&t<d.length;t++){var o,a=d[t],p=f.p,v=a[2];n>3?(o=v===r)&&(c=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=e):a[0]<=p&&((o=n<2&&p<a[1])?(i=0,f.v=r,f.n=a[1]):p<v&&(o=n<3||a[0]>r||r>v)&&(a[4]=n,a[5]=r,f.n=v,i=0))}if(o||n>1)return l;throw s=!0,r}return function(o,d,v){if(u>1)throw TypeError("Generator is already running");for(s&&1===d&&p(d,v),i=d,c=v;(t=i<2?e:c)||!s;){a||(i?i<3?(i>1&&(f.n=-1),p(i,c)):f.n=c:f.v=c);try{if(u=2,a){if(i||(o="next"),t=a[o]){if(!(t=t.call(a,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,i<2&&(i=0)}else 1===i&&(t=a.return)&&t.call(a),i<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=e}else if((t=(s=f.n<0)?c:n.call(r,f))!==l)break}catch(t){a=e,i=1,c=t}finally{u=1}}return{value:t,done:s}}}(n,o,a),!0),d}var l={};function u(){}function d(){}function s(){}t=Object.getPrototypeOf;var f=[][r]?t(t([][r]())):(c(t={},r,function(){return this}),t),p=s.prototype=u.prototype=Object.create(f);function v(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,c(e,o,"GeneratorFunction")),e.prototype=Object.create(p),e}return d.prototype=s,c(p,"constructor",s),c(s,"constructor",d),d.displayName="GeneratorFunction",c(s,o,"GeneratorFunction"),c(p),c(p,o,"Generator"),c(p,r,function(){return this}),c(p,"toString",function(){return"[object Generator]"}),(i=function(){return{w:a,m:v}})()}function c(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}c=function(e,t,n,r){function a(t,n){c(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},c(e,t,n,r)}function l(e,t,n,r,o,a,i){try{var c=e[a](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,o)}function u(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){l(a,r,o,i,c,"next",e)}function c(e){l(a,r,o,i,c,"throw",e)}i(void 0)})}}function d(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return s(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw a}}}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function f(){(document.getElementById("talk-container")||window.location.pathname.includes("/call/"))&&(console.log("[FederatedTalkLink] Initializing Talk integration"),new MutationObserver(function(e){var t,n=d(e);try{for(n.s();!(t=n.n()).done;){var r,o=d(t.value.addedNodes);try{for(o.s();!(r=o.n()).done;){var a=r.value;if(a.nodeType===Node.ELEMENT_NODE){var i,c,l=(null===(i=a.querySelector)||void 0===i?void 0:i.call(a,".conversation-settings"))||(null!==(c=a.classList)&&void 0!==c&&c.contains("conversation-settings")?a:null);l&&p(l)}}}catch(e){o.e(e)}finally{o.f()}}}catch(e){n.e(e)}finally{n.f()}}).observe(document.body,{childList:!0,subtree:!0}))}function p(e){var t;if(!e.querySelector(".federated-link-button")){var n=e.querySelector(".conversation-name")||e.querySelector("[data-conversation-name]")||e.querySelector(".displayname");if(n){var r=(null===(t=n.textContent)||void 0===t?void 0:t.trim())||n.getAttribute("data-conversation-name");if(r){var o=document.createElement("button");o.className="federated-link-button button",o.innerHTML='\n        <span class="icon icon-link"></span>\n        <span>Generate Federated Link</span>\n    ',o.style.cssText="margin: 10px 0; display: flex; align-items: center; gap: 8px;",o.addEventListener("click",u(i().m(function e(){return i().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,v(r);case 1:return e.a(2)}},e)}))),(e.querySelector(".conversation-actions")||e.querySelector(".settings-actions")||e).appendChild(o)}}else console.log("[FederatedTalkLink] Could not find conversation name element")}}function v(e){return y.apply(this,arguments)}function y(){return(y=u(i().m(function e(t){var n,c,l,u,d,s;return i().w(function(e){for(;;)switch(e.p=e.n){case 0:return(0,o.cf)('Generating federated link for "'.concat(t,'"...')),e.p=1,e.n=2,a.Ay.get((0,r.KT)("/apps/federatedtalklink/api/v1/link"),{params:{roomName:t}});case 2:if(c=e.v,null==(l=null===(n=c.data.ocs)||void 0===n?void 0:n.data)||!l.link){e.n=7;break}return e.p=3,e.n=4,navigator.clipboard.writeText(l.link);case 4:(0,o.Te)("Federated link copied to clipboard: ".concat(l.link)),e.n=6;break;case 5:e.p=5,e.v,(0,o.Te)("Federated link generated: ".concat(l.link)),prompt("Copy this link:",l.link);case 6:e.n=8;break;case 7:throw new Error("No link returned");case 8:e.n=10;break;case 9:e.p=9,s=e.v,d=(null===(u=s.response)||void 0===u||null===(u=u.data)||void 0===u||null===(u=u.ocs)||void 0===u||null===(u=u.data)||void 0===u?void 0:u.error)||s.message||"Failed to generate federated link",(0,o.Qg)(d);case 10:return e.a(2)}},e,null,[[3,5],[1,9]])}))).apply(this,arguments)}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",f):f()}},o={};function a(e){var t=o[e];if(void 0!==t)return t.exports;var n=o[e]={id:e,exports:{}};return r[e].call(n.exports,n,n.exports,a),n.exports}a.m=r,e=[],a.O=(t,n,r,o)=>{if(!n){var i=1/0;for(d=0;d<e.length;d++){for(var[n,r,o]=e[d],c=!0,l=0;l<n.length;l++)(!1&o||i>=o)&&Object.keys(a.O).every(e=>a.O[e](n[l]))?n.splice(l--,1):(c=!1,o<i&&(i=o));if(c){e.splice(d--,1);var u=r();void 0!==u&&(t=u)}}return t}o=o||0;for(var d=e.length;d>0&&e[d-1][2]>o;d--)e[d]=e[d-1];e[d]=[n,r,o]},a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.f={},a.e=e=>Promise.all(Object.keys(a.f).reduce((t,n)=>(a.f[n](e,t),t),[])),a.u=e=>e+"-13f3371e171971bf5529.js",a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),t={},n="federatedtalklink:",a.l=(e,r,o,i)=>{if(t[e])t[e].push(r);else{var c,l;if(void 0!==o)for(var u=document.getElementsByTagName("script"),d=0;d<u.length;d++){var s=u[d];if(s.getAttribute("src")==e||s.getAttribute("data-webpack")==n+o){c=s;break}}c||(l=!0,(c=document.createElement("script")).charset="utf-8",a.nc&&c.setAttribute("nonce",a.nc),c.setAttribute("data-webpack",n+o),c.src=e),t[e]=[r];var f=(n,r)=>{c.onerror=c.onload=null,clearTimeout(p);var o=t[e];if(delete t[e],c.parentNode&&c.parentNode.removeChild(c),o&&o.forEach(e=>e(r)),n)return n(r)},p=setTimeout(f.bind(null,void 0,{type:"timeout",target:c}),12e4);c.onerror=f.bind(null,c.onerror),c.onload=f.bind(null,c.onload),l&&document.head.appendChild(c)}},a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;a.g.importScripts&&(e=a.g.location+"");var t=a.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var r=n.length-1;r>-1&&(!e||!/^http(s?):/.test(e));)e=n[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),a.p=e})(),(()=>{a.b="undefined"!=typeof document&&document.baseURI||self.location.href;var e={307:0};a.f.j=(t,n)=>{var r=a.o(e,t)?e[t]:void 0;if(0!==r)if(r)n.push(r[2]);else{var o=new Promise((n,o)=>r=e[t]=[n,o]);n.push(r[2]=o);var i=a.p+a.u(t),c=new Error;a.l(i,n=>{if(a.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var o=n&&("load"===n.type?"missing":n.type),i=n&&n.target&&n.target.src;c.message="Loading chunk "+t+" failed.\n("+o+": "+i+")",c.name="ChunkLoadError",c.type=o,c.request=i,r[1](c)}},"chunk-"+t,t)}},a.O.j=t=>0===e[t];var t=(t,n)=>{var r,o,[i,c,l]=n,u=0;if(i.some(t=>0!==e[t])){for(r in c)a.o(c,r)&&(a.m[r]=c[r]);if(l)var d=l(a)}for(t&&t(n);u<i.length;u++)o=i[u],a.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return a.O(d)},n=self.webpackChunkfederatedtalklink=self.webpackChunkfederatedtalklink||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),a.nc=void 0;var i=a.O(void 0,[397],()=>a(244));i=a.O(i)})();