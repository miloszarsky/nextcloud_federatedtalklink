/*! For license information please see federatedtalklink-main.js.LICENSE.txt */
(()=>{"use strict";var e,r,o,a={1804(e,t,n){n.d(t,{A:()=>l});var r=n(1601),o=n.n(r),a=n(6314),i=n.n(a)()(o());i.push([e.id,".federated-talk-link[data-v-ca83d1fa]{padding:20px;max-width:800px;margin:0 auto}.federated-talk-link__header[data-v-ca83d1fa]{margin-bottom:30px;text-align:center}.federated-talk-link__header h1[data-v-ca83d1fa]{font-size:24px;font-weight:600;margin-bottom:10px}.federated-talk-link__header .description[data-v-ca83d1fa]{color:var(--color-text-maxcontrast);font-size:14px}.federated-talk-link__not-configured[data-v-ca83d1fa]{margin-top:50px}.federated-talk-link__content[data-v-ca83d1fa]{background:var(--color-main-background);border-radius:var(--border-radius-large);padding:20px}",""]);const l=i},3749(e,r,o){var a=o(2893),i=o(2981),l=o(2378),s=o(8195),d=o(2507),c=o(1595),u=o(3814),p=o(5289),m=o(6802),f=o(2182),v=o(4095),k=o(8289),g=o(371),b=o(9933),_=o(59),y=o(4178),h=o(6134),x=o(9675),A=o(8143);function C(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var s=r&&r.prototype instanceof l?r:l,d=Object.create(s.prototype);return N(d,"_invoke",function(n,r,o){var a,l,s,d=0,c=o||[],u=!1,p={p:0,n:0,v:e,a:m,f:m.bind(e,4),d:function(t,n){return a=t,l=0,s=e,p.n=n,i}};function m(n,r){for(l=n,s=r,t=0;!u&&d&&!o&&t<c.length;t++){var o,a=c[t],m=p.p,f=a[2];n>3?(o=f===r)&&(s=a[(l=a[4])?5:(l=3,3)],a[4]=a[5]=e):a[0]<=m&&((o=n<2&&m<a[1])?(l=0,p.v=r,p.n=a[1]):m<f&&(o=n<3||a[0]>r||r>f)&&(a[4]=n,a[5]=r,p.n=f,l=0))}if(o||n>1)return i;throw u=!0,r}return function(o,c,f){if(d>1)throw TypeError("Generator is already running");for(u&&1===c&&m(c,f),l=c,s=f;(t=l<2?e:s)||!u;){a||(l?l<3?(l>1&&(p.n=-1),m(l,s)):p.n=s:p.v=s);try{if(d=2,a){if(l||(o="next"),t=a[o]){if(!(t=t.call(a,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,l<2&&(l=0)}else 1===l&&(t=a.return)&&t.call(a),l<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),l=1);a=e}else if((t=(u=p.n<0)?s:n.call(r,p))!==i)break}catch(t){a=e,l=1,s=t}finally{d=1}}return{value:t,done:u}}}(n,o,a),!0),d}var i={};function l(){}function s(){}function d(){}t=Object.getPrototypeOf;var c=[][r]?t(t([][r]())):(N(t={},r,function(){return this}),t),u=d.prototype=l.prototype=Object.create(c);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,N(e,o,"GeneratorFunction")),e.prototype=Object.create(u),e}return s.prototype=d,N(u,"constructor",d),N(d,"constructor",s),s.displayName="GeneratorFunction",N(d,o,"GeneratorFunction"),N(u),N(u,o,"Generator"),N(u,r,function(){return this}),N(u,"toString",function(){return"[object Generator]"}),(C=function(){return{w:a,m:p}})()}function N(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}N=function(e,t,n,r){function a(t,n){N(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},N(e,t,n,r)}function w(e,t,n,r,o,a,i){try{var l=e[a](i),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(r,o)}function E(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){w(a,r,o,i,l,"next",e)}function l(e){w(a,r,o,i,l,"throw",e)}i(void 0)})}}const L={name:"LinkGenerator",components:{NcTextField:f.A,NcButton:v.A,NcLoadingIcon:k.A,NcNoteCard:g.A,NcEmptyContent:d.A,LinkVariant:b.A,ContentCopy:_.A,OpenInNew:y.A,Refresh:h.A,ForumOutline:x.A,EmailOutline:A.A},data:function(){return{roomName:"",loading:!1,loadingRooms:!1,roomsLoaded:!1,error:"",result:null,rooms:[],emailAddress:"",sendingEmail:!1}},mounted:function(){this.loadRooms()},methods:{generateLink:function(){var e=this;return E(C().m(function t(){var n,r,o,a,i;return C().w(function(t){for(;;)switch(t.p=t.n){case 0:if(e.roomName){t.n=1;break}return t.a(2);case 1:return e.loading=!0,e.error="",e.result=null,t.p=2,t.n=3,m.Ay.get((0,u.KT)("/apps/federatedtalklink/api/v1/link"),{params:{roomName:e.roomName}});case 3:if(r=t.v,null==(o=null===(n=r.data.ocs)||void 0===n?void 0:n.data)||!o.link){t.n=4;break}e.result=o,(0,p.Te)("Link generated successfully!"),t.n=5;break;case 4:throw new Error("No link returned");case 5:t.n=7;break;case 6:t.p=6,i=t.v,e.error=(null===(a=i.response)||void 0===a||null===(a=a.data)||void 0===a||null===(a=a.ocs)||void 0===a||null===(a=a.data)||void 0===a?void 0:a.error)||i.message||"Failed to generate link",(0,p.Qg)(e.error);case 7:return t.p=7,e.loading=!1,t.f(7);case 8:return t.a(2)}},t,null,[[2,6,7,8]])}))()},loadRooms:function(){var e=this;return E(C().m(function t(){var n,r;return C().w(function(t){for(;;)switch(t.p=t.n){case 0:return e.loadingRooms=!0,t.p=1,t.n=2,m.Ay.get((0,u.KT)("/apps/federatedtalklink/api/v1/rooms"));case 2:r=t.v,e.rooms=(null===(n=r.data.ocs)||void 0===n||null===(n=n.data)||void 0===n?void 0:n.rooms)||[],e.roomsLoaded=!0,t.n=4;break;case 3:t.p=3,t.v,(0,p.Qg)("Failed to load rooms"),e.rooms=[];case 4:return t.p=4,e.loadingRooms=!1,t.f(4);case 5:return t.a(2)}},t,null,[[1,3,4,5]])}))()},selectRoom:function(e){this.roomName=e.name,this.generateLink()},selectLink:function(e){e.target.select()},copyLink:function(){var e=this;return E(C().m(function t(){var n;return C().w(function(t){for(;;)switch(t.p=t.n){case 0:if(null!==(n=e.result)&&void 0!==n&&n.link){t.n=1;break}return t.a(2);case 1:return t.p=1,t.n=2,navigator.clipboard.writeText(e.result.link);case 2:(0,p.Te)("Link copied to clipboard!"),t.n=4;break;case 3:t.p=3,t.v,(0,p.Qg)("Failed to copy link");case 4:return t.a(2)}},t,null,[[1,3]])}))()},openLink:function(){var e;null!==(e=this.result)&&void 0!==e&&e.link&&window.open(this.result.link,"_blank")},sendEmail:function(){var e=this;return E(C().m(function t(){var n,r,o,a,i,l,s,d;return C().w(function(t){for(;;)switch(t.p=t.n){case 0:if(e.emailAddress&&null!==(n=e.result)&&void 0!==n&&n.link){t.n=1;break}return t.a(2);case 1:return e.sendingEmail=!0,t.p=2,t.n=3,m.Ay.post((0,u.KT)("/apps/federatedtalklink/api/v1/email"),{email:e.emailAddress,link:e.result.link,roomName:(null===(r=e.result.roomInfo)||void 0===r?void 0:r.name)||""});case 3:a=t.v,null!=(i=null===(o=a.data.ocs)||void 0===o?void 0:o.data)&&i.message?((0,p.Te)(i.message),e.emailAddress=""):((0,p.Te)("Email sent successfully!"),e.emailAddress=""),t.n=5;break;case 4:t.p=4,d=t.v,s=(null===(l=d.response)||void 0===l||null===(l=l.data)||void 0===l||null===(l=l.ocs)||void 0===l||null===(l=l.data)||void 0===l?void 0:l.error)||d.message||"Failed to send email",(0,p.Qg)(s);case 5:return t.p=5,e.sendingEmail=!1,t.f(5);case 6:return t.a(2)}},t,null,[[2,4,5,6]])}))()}}};var O=o(5072),T=o.n(O),S=o(7825),j=o.n(S),R=o(7659),P=o.n(R),F=o(5056),z=o.n(F),G=o(540),I=o.n(G),B=o(1113),Q=o.n(B),$=o(5938),K={};K.styleTagTransform=Q(),K.setAttributes=z(),K.insert=P().bind(null,"head"),K.domAPI=j(),K.insertStyleElement=I(),T()($.A,K),$.A&&$.A.locals&&$.A.locals;var M=o(4486),U=(0,M.A)(L,function(){var e=this,t=e._self._c;return t("div",{staticClass:"link-generator"},[t("div",{staticClass:"link-generator__input"},[t("NcTextField",{attrs:{disabled:e.loading,placeholder:"Enter room name...",label:"Room name"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.generateLink.apply(null,arguments)}},model:{value:e.roomName,callback:function(t){e.roomName=t},expression:"roomName"}}),e._v(" "),t("NcButton",{attrs:{type:"primary",disabled:!e.roomName||e.loading},on:{click:e.generateLink},scopedSlots:e._u([{key:"icon",fn:function(){return[e.loading?t("NcLoadingIcon",{attrs:{size:20}}):t("LinkVariant",{attrs:{size:20}})]},proxy:!0}])},[e._v("\n\t\t\t"+e._s(e.loading?"Searching...":"Generate Link")+"\n\t\t")])],1),e._v(" "),e.error?t("div",{staticClass:"link-generator__error"},[t("NcNoteCard",{attrs:{type:"error"}},[e._v("\n\t\t\t"+e._s(e.error)+"\n\t\t")])],1):e._e(),e._v(" "),e.result?t("div",{staticClass:"link-generator__result"},[t("NcNoteCard",{attrs:{type:"success"}},[t("h4",[e._v("Link Generated Successfully!")]),e._v(" "),e.result.roomInfo?t("div",{staticClass:"room-info"},[t("strong",[e._v("Room:")]),e._v(" "+e._s(e.result.roomInfo.name)+"\n\t\t\t")]):e._e()]),e._v(" "),t("div",{staticClass:"link-display"},[t("label",[e._v("Generated Link:")]),e._v(" "),t("div",{staticClass:"link-container"},[t("input",{staticClass:"link-input",attrs:{type:"text",readonly:""},domProps:{value:e.result.link},on:{click:e.selectLink}}),e._v(" "),t("NcButton",{attrs:{type:"secondary"},on:{click:e.copyLink},scopedSlots:e._u([{key:"icon",fn:function(){return[t("ContentCopy",{attrs:{size:20}})]},proxy:!0}],null,!1,1478045380)},[e._v("\n\t\t\t\t\tCopy\n\t\t\t\t")]),e._v(" "),t("NcButton",{attrs:{type:"secondary"},on:{click:e.openLink},scopedSlots:e._u([{key:"icon",fn:function(){return[t("OpenInNew",{attrs:{size:20}})]},proxy:!0}],null,!1,969454087)},[e._v("\n\t\t\t\t\tOpen\n\t\t\t\t")])],1)]),e._v(" "),t("div",{staticClass:"email-send"},[t("label",[e._v("Send Link by Email:")]),e._v(" "),t("div",{staticClass:"email-container"},[t("NcTextField",{attrs:{disabled:e.sendingEmail,placeholder:"Enter email address...",type:"email"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.sendEmail.apply(null,arguments)}},model:{value:e.emailAddress,callback:function(t){e.emailAddress=t},expression:"emailAddress"}}),e._v(" "),t("NcButton",{attrs:{type:"primary",disabled:!e.emailAddress||e.sendingEmail},on:{click:e.sendEmail},scopedSlots:e._u([{key:"icon",fn:function(){return[e.sendingEmail?t("NcLoadingIcon",{attrs:{size:20}}):t("EmailOutline",{attrs:{size:20}})]},proxy:!0}],null,!1,4057158727)},[e._v("\n\t\t\t\t\t"+e._s(e.sendingEmail?"Sending...":"Send Email")+"\n\t\t\t\t")])],1)])],1):e._e(),e._v(" "),t("div",{staticClass:"link-generator__rooms"},[t("h3",[e._v("Available Rooms")]),e._v(" "),t("NcButton",{attrs:{type:"tertiary",disabled:e.loadingRooms},on:{click:e.loadRooms},scopedSlots:e._u([{key:"icon",fn:function(){return[e.loadingRooms?t("NcLoadingIcon",{attrs:{size:20}}):t("Refresh",{attrs:{size:20}})]},proxy:!0}])},[e._v("\n\t\t\t"+e._s(e.loadingRooms?"Loading...":"Refresh Rooms")+"\n\t\t")]),e._v(" "),e.rooms.length>0?t("div",{staticClass:"rooms-list"},e._l(e.rooms,function(n){return t("div",{key:n.token,staticClass:"room-item",on:{click:function(t){return e.selectRoom(n)}}},[t("span",{staticClass:"room-name"},[e._v(e._s(n.name))]),e._v(" "),t("span",{staticClass:"room-token"},[e._v(e._s(n.token))])])}),0):e.roomsLoaded?t("div",{staticClass:"no-rooms"},[t("NcEmptyContent",{attrs:{name:"No rooms found",description:"No rooms are available on the external server."},scopedSlots:e._u([{key:"icon",fn:function(){return[t("ForumOutline",{attrs:{size:32}})]},proxy:!0}])})],1):e._e()],1)])},[],!1,null,"f6be401c",null);const V=U.exports,q={name:"App",components:{NcContent:l.A,NcAppContent:s.A,NcEmptyContent:d.A,AlertCircle:c.A,LinkGenerator:V},data:function(){return{isConfigured:!1}},created:function(){var e=(0,i.C)("federatedtalklink","app-config",{});this.isConfigured=e.isConfigured||!1}};var D=o(1804),H={};H.styleTagTransform=Q(),H.setAttributes=z(),H.insert=P().bind(null,"head"),H.domAPI=j(),H.insertStyleElement=I(),T()(D.A,H),D.A&&D.A.locals&&D.A.locals;const J=(0,M.A)(q,function(){var e=this,t=e._self._c;return t("NcContent",{attrs:{"app-name":"federatedtalklink"}},[t("NcAppContent",[t("div",{staticClass:"federated-talk-link"},[t("div",{staticClass:"federated-talk-link__header"},[t("h1",[e._v("Federated Talk Link Generator")]),e._v(" "),t("p",{staticClass:"description"},[e._v("\n\t\t\t\t\tGenerate direct links to Talk rooms on external Nextcloud servers.\n\t\t\t\t")])]),e._v(" "),e.isConfigured?t("div",{staticClass:"federated-talk-link__content"},[t("LinkGenerator")],1):t("div",{staticClass:"federated-talk-link__not-configured"},[t("NcEmptyContent",{attrs:{name:"Not Configured",description:"Please ask an administrator to configure the Federated Talk Link settings."},scopedSlots:e._u([{key:"icon",fn:function(){return[t("AlertCircle",{attrs:{size:64}})]},proxy:!0}],null,!1,1332195444)})],1)])])],1)},[],!1,null,"ca83d1fa",null).exports;a.Ay.mixin({methods:{t,n}}),(new(a.Ay.extend(J))).$mount("#federatedtalklink-app")},5938(e,t,n){n.d(t,{A:()=>l});var r=n(1601),o=n.n(r),a=n(6314),i=n.n(a)()(o());i.push([e.id,".link-generator__input[data-v-f6be401c]{display:flex;gap:10px;align-items:flex-end;margin-bottom:20px}.link-generator__input[data-v-f6be401c]>:first-child{flex:1}.link-generator__error[data-v-f6be401c]{margin-bottom:20px}.link-generator__result[data-v-f6be401c]{margin-bottom:30px}.link-generator__result h4[data-v-f6be401c]{margin:0}.link-generator__result .room-info[data-v-f6be401c]{margin-top:5px}.link-generator__result .link-display[data-v-f6be401c]{margin-top:15px}.link-generator__result .link-display label[data-v-f6be401c]{display:block;font-weight:600;margin-bottom:5px}.link-generator__result .link-display .link-container[data-v-f6be401c]{display:flex;gap:10px;align-items:center}.link-generator__result .link-display .link-container .link-input[data-v-f6be401c]{flex:1;padding:10px;border:1px solid var(--color-border);border-radius:var(--border-radius);background:var(--color-background-dark);font-family:monospace;font-size:13px}.link-generator__result .email-send[data-v-f6be401c]{margin-top:20px;padding-top:20px;border-top:1px solid var(--color-border)}.link-generator__result .email-send label[data-v-f6be401c]{display:block;font-weight:600;margin-bottom:5px}.link-generator__result .email-send .email-container[data-v-f6be401c]{display:flex;gap:10px;align-items:flex-end}.link-generator__result .email-send .email-container[data-v-f6be401c]>:first-child{flex:1}.link-generator__rooms h3[data-v-f6be401c]{margin-bottom:10px}.link-generator__rooms .rooms-list[data-v-f6be401c]{margin-top:15px;border:1px solid var(--color-border);border-radius:var(--border-radius);max-height:300px;overflow-y:auto}.link-generator__rooms .rooms-list .room-item[data-v-f6be401c]{display:flex;justify-content:space-between;padding:12px 15px;border-bottom:1px solid var(--color-border);cursor:pointer;transition:background-color .2s}.link-generator__rooms .rooms-list .room-item[data-v-f6be401c]:last-child{border-bottom:none}.link-generator__rooms .rooms-list .room-item[data-v-f6be401c]:hover{background:var(--color-background-hover)}.link-generator__rooms .rooms-list .room-item .room-name[data-v-f6be401c]{font-weight:500}.link-generator__rooms .rooms-list .room-item .room-token[data-v-f6be401c]{color:var(--color-text-maxcontrast);font-family:monospace;font-size:12px}.link-generator__rooms .no-rooms[data-v-f6be401c]{margin-top:20px}",""]);const l=i}},i={};function l(e){var t=i[e];if(void 0!==t)return t.exports;var n=i[e]={id:e,exports:{}};return a[e].call(n.exports,n,n.exports,l),n.exports}l.m=a,e=[],l.O=(t,n,r,o)=>{if(!n){var a=1/0;for(c=0;c<e.length;c++){for(var[n,r,o]=e[c],i=!0,s=0;s<n.length;s++)(!1&o||a>=o)&&Object.keys(l.O).every(e=>l.O[e](n[s]))?n.splice(s--,1):(i=!1,o<a&&(a=o));if(i){e.splice(c--,1);var d=r();void 0!==d&&(t=d)}}return t}o=o||0;for(var c=e.length;c>0&&e[c-1][2]>o;c--)e[c]=e[c-1];e[c]=[n,r,o]},l.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return l.d(t,{a:t}),t},l.d=(e,t)=>{for(var n in t)l.o(t,n)&&!l.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},l.f={},l.e=e=>Promise.all(Object.keys(l.f).reduce((t,n)=>(l.f[n](e,t),t),[])),l.u=e=>e+"-13f3371e171971bf5529.js",l.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),l.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r={},o="federatedtalklink:",l.l=(e,t,n,a)=>{if(r[e])r[e].push(t);else{var i,s;if(void 0!==n)for(var d=document.getElementsByTagName("script"),c=0;c<d.length;c++){var u=d[c];if(u.getAttribute("src")==e||u.getAttribute("data-webpack")==o+n){i=u;break}}i||(s=!0,(i=document.createElement("script")).charset="utf-8",l.nc&&i.setAttribute("nonce",l.nc),i.setAttribute("data-webpack",o+n),i.src=e),r[e]=[t];var p=(t,n)=>{i.onerror=i.onload=null,clearTimeout(m);var o=r[e];if(delete r[e],i.parentNode&&i.parentNode.removeChild(i),o&&o.forEach(e=>e(n)),t)return t(n)},m=setTimeout(p.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=p.bind(null,i.onerror),i.onload=p.bind(null,i.onload),s&&document.head.appendChild(i)}},l.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;l.g.importScripts&&(e=l.g.location+"");var t=l.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var r=n.length-1;r>-1&&(!e||!/^http(s?):/.test(e));)e=n[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),l.p=e})(),(()=>{l.b="undefined"!=typeof document&&document.baseURI||self.location.href;var e={239:0};l.f.j=(t,n)=>{var r=l.o(e,t)?e[t]:void 0;if(0!==r)if(r)n.push(r[2]);else{var o=new Promise((n,o)=>r=e[t]=[n,o]);n.push(r[2]=o);var a=l.p+l.u(t),i=new Error;l.l(a,n=>{if(l.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var o=n&&("load"===n.type?"missing":n.type),a=n&&n.target&&n.target.src;i.message="Loading chunk "+t+" failed.\n("+o+": "+a+")",i.name="ChunkLoadError",i.type=o,i.request=a,r[1](i)}},"chunk-"+t,t)}},l.O.j=t=>0===e[t];var t=(t,n)=>{var r,o,[a,i,s]=n,d=0;if(a.some(t=>0!==e[t])){for(r in i)l.o(i,r)&&(l.m[r]=i[r]);if(s)var c=s(l)}for(t&&t(n);d<a.length;d++)o=a[d],l.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return l.O(c)},n=self.webpackChunkfederatedtalklink=self.webpackChunkfederatedtalklink||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),l.nc=void 0;var s=l.O(void 0,[397],()=>l(3749));s=l.O(s)})();